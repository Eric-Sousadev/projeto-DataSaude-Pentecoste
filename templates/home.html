{% extends "base.html" %}
{% block content %}

<h1 class="page-title">Dashboard Geral</h1>

<div class="cards-container">
    <div class="card">
        <div class="card-title">Total de Casos</div>
        <div class="card-value">{{ total_casos }}</div>
    </div>

    <div class="card">
        <div class="card-title">Dengue</div>
        <div class="card-value" style="color: #ff6b6b;">{{ total_dengue }}</div>
    </div>

    <div class="card">
        <div class="card-title">Chikungunya</div>
        <div class="card-value" style="color: #ffd43b;">{{ total_chikungunya }}</div>
    </div>

    <div class="card">
        <div class="card-title">Zika</div>
        <div class="card-value" style="color: #a78bfa;">{{ total_zika }}</div>
    </div>

    <div class="card">
        <div class="card-title">Munic√≠pios</div>
        <div class="card-value">{{ municipios }}</div>
    </div>
</div>

<h2 class="section-title">An√°lises e Gr√°ficos Epidemiol√≥gicos</h2>

<div class="graficos-wrapper">
    <div class="graph-container">
        <h3>Casos por Ano</h3>
        <canvas id="graf1CasosAno"></canvas>
    </div>

    <div class="graph-container">
        <h3>Distribui√ß√£o por Doen√ßa</h3>
        <canvas id="graf2Doenca"></canvas>
    </div>

    <div class="graph-container">
        <h3>Top 10 Bairros com Mais Casos</h3>
        <canvas id="graf3Bairros"></canvas>
    </div>

    <div class="graph-container">
        <h3>Impacto das Chuvas nos Casos de Dengue</h3>
        <canvas id="graf4Chuva"></canvas>
    </div>

    <div class="graph-container">
        <h3>Interna√ß√µes por Ano</h3>
        <canvas id="graf5Internacoes"></canvas>
    </div>

    <div class="graph-container">
        <h3>Mortalidade por Ano</h3>
        <canvas id="graf6Mortes"></canvas>
    </div>

    <div class="graph-container">
        <h3>Capacidade vs Atendimentos por M√™s</h3>
        <canvas id="graf7Capacidade"></canvas>
    </div>

    <div class="graph-container">
        <h3>Tempo M√©dio de Espera por Bairro</h3>
        <canvas id="graf8Tempo"></canvas>
    </div>
</div>

<!-- Se√ß√£o: Sintomas das Doen√ßas -->
<section class="sintomas-section">
    <h2 class="sintomas-title">Sintomas das Doen√ßas</h2>

    <div class="sintomas-grid">
        <article class="sintoma-card">
            <div class="sintoma-media">
                <img src="\static\images\imgSite\virus_dengue.png" alt="Imagem Dengue" class="virus-img">
            </div>
            <div class="sintoma-body">
                <h3 class="sintoma-name">Dengue</h3>
                <div class="sintoma-text">
                    <p>üïê <strong>1. In√≠cio s√∫bito (primeiras horas a 1¬∫ dia)</strong></p>
                    <ul>
                        <li>Febre alta (39‚Äì40¬∞C)</li>
                        <li>Dor de cabe√ßa intensa</li>
                        <li>Dor atr√°s dos olhos (dor retro-orbital)</li>
                    </ul>

                    <p>üïë <strong>2. Primeiros dias (1¬∫ ao 3¬∫ dia)</strong></p>
                    <ul>
                        <li>Dores musculares fortes</li>
                        <li>Dores nas articula√ß√µes</li>
                        <li>Cansa√ßo extremo</li>
                        <li>N√°useas e/ou v√¥mitos</li>
                        <li>Mal-estar geral</li>
                        <li>Manchas vermelhas na pele (podem aparecer a partir do 2¬∫ dia)</li>
                    </ul>

                    <p>üïí <strong>3. Fase cr√≠tica ‚Äì sinais de alerta (3¬∫ ao 6¬∫ dia)</strong></p>
                    <p class="alert">‚ö† Indicativos de evolu√ß√£o para dengue grave ‚Äî precisam de atendimento imediato:</p>
                    <ul>
                        <li>Dor abdominal forte e cont√≠nua</li>
                        <li>V√¥mitos persistentes</li>
                        <li>Sangramentos (nariz, gengiva, urina, fezes, menstrua√ß√£o intensa)</li>
                        <li>Tontura ou desmaio</li>
                        <li>Agita√ß√£o ou sonol√™ncia excessiva</li>
                        <li>Dificuldade para respirar</li>
                    </ul>

                    <p>üïì <strong>4. Recupera√ß√£o (a partir do 6¬∫ dia)</strong></p>
                    <ul>
                        <li>Queda gradual da febre</li>
                        <li>Melhora da dor corporal</li>
                        <li>Persist√™ncia de cansa√ßo por dias ou semanas</li>
                    </ul>
                </div>
            </div>
        </article>

        <article class="sintoma-card">
            <div class="sintoma-media">
                <img src="\static\images\imgSite\zikavirus.png" alt="Imagem Zika" class="virus-img">
            </div>
            <div class="sintoma-body">
                <h3 class="sintoma-name">Zika</h3>
                <div class="sintoma-text">
                    <p>ü¶ü <strong>Sintomas Principais (mais comuns)</strong></p>
                    <ul>
                        <li>Manchas vermelhas na pele (exantema)</li>
                        <li>Coceira intensa</li>
                        <li>Febre baixa (geralmente abaixo de 38,5¬∞C)</li>
                        <li>Dor nas articula√ß√µes (normalmente mais leve que na chikungunya)</li>
                        <li>Dor muscular leve</li>
                    </ul>

                    <p>üëÄ <strong>Sintomas Oftalmol√≥gicos</strong></p>
                    <ul>
                        <li>Conjuntivite n√£o purulenta (olhos vermelhos sem secre√ß√£o)</li>
                        <li>Dor ou desconforto nos olhos</li>
                    </ul>

                    <p>üí° <strong>Sintomas Neurol√≥gicos (raros)</strong></p>
                    <ul>
                        <li>Formigamento</li>
                        <li>Fraqueza muscular</li>
                        <li>Em casos espec√≠ficos: S√≠ndrome de Guillain-Barr√©</li>
                    </ul>

                    <p>üß† <strong>Riscos em Gestantes</strong></p>
                    <ul>
                        <li>Microcefalia e altera√ß√µes neurol√≥gicas no beb√™</li>
                    </ul>

                    <p>‚è≥ <strong>Dura√ß√£o</strong> ‚Äî Geralmente 2 a 7 dias; a maioria dos casos √© leve.</p>
                </div>
            </div>
        </article>

        <article class="sintoma-card">
            <div class="sintoma-media">
                <img src="\static\images\imgSite\viruschikungunya-2.png" alt="Imagem Chikungunya" class="virus-img">
            </div>
            <div class="sintoma-body">
                <h3 class="sintoma-name">Chikungunya</h3>
                <div class="sintoma-text">
                    <p>ü¶ü <strong>Sintomas Principais</strong></p>
                    <ul>
                        <li>Febre alta de in√≠cio s√∫bito (geralmente acima de 38,5¬∞C)</li>
                        <li>Dores intensas nas articula√ß√µes (p√©s, m√£os, tornozelos, punhos)</li>
                        <li>Dor de cabe√ßa</li>
                        <li>Dor muscular</li>
                        <li>Cansa√ßo extremo</li>
                        <li>Incha√ßo nas articula√ß√µes</li>
                    </ul>

                    <p>ü©∏ <strong>Sintomas Cut√¢neos</strong></p>
                    <ul>
                        <li>Manchas vermelhas na pele (exantema)</li>
                        <li>Coceira</li>
                    </ul>

                    <p>üí° <strong>Sintomas Gastrointestinais</strong></p>
                    <ul>
                        <li>N√°useas</li>
                        <li>V√¥mitos</li>
                    </ul>

                    <p>‚è≥ <strong>Sintomas Prolongados</strong></p>
                    <ul>
                        <li>Dor articular persistente (semanas ou meses)</li>
                        <li>Rigidez nas articula√ß√µes</li>
                    </ul>
                </div>
            </div>
        </article>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // ===== DADOS DO FLASK =====
const anos = {{ anos | tojson }};
const casosAno = {{ casos_ano | tojson }};

const distroLabels = {{ distro_labels | tojson }};
const distroValues = {{ distro_values | tojson }};

const bairros = {{ bairros | tojson }};
const casosBairros = {{ casos_bairros | tojson }};

const chuvaVals = {{ chuva_vals | tojson }};
const dengueVals = {{ dengue_vals | tojson }};

const internacoes = {{ internacoes_ano | tojson }};
const mortes = {{ mortes_ano | tojson }};

const mesesLabels = {{ meses_labels | tojson }};
const atendimentosMes = {{ atendimentos_mes | tojson }};
const capacidadeMes = {{ capacidade_mes | tojson }};

const bairrosTempo = {{ bairros_tempo | tojson }};
const temposEspera = {{ tempos | tojson }};

// ===== CORES EPIDEMIOL√ìGICAS =====
const corDengue = "#FF6B6B";
const corChikungunya = "#FFD43B";
const corZika = "#A78BFA";
const corInternacoes = "#FF922B";
const corMortes = "#DC2626";
const corCapacidade = "#4F46E5";

// ===== GR√ÅFICO 1: CASOS POR ANO =====
new Chart(document.getElementById("graf1CasosAno"), {
    type: "bar",
    data: {
        labels: anos,
        datasets: [{
            label: "Total de Casos",
            data: casosAno,
            backgroundColor: "#4F46E5",
            borderRadius: 6,
            borderSkipped: false
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: { display: true }
        },
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// ===== GR√ÅFICO 2: DISTRIBUI√á√ÉO POR DOEN√áA =====
new Chart(document.getElementById("graf2Doenca"), {
    type: "doughnut",
    data: {
        labels: distroLabels,
        datasets: [{
            data: distroValues,
            backgroundColor: [corDengue, corChikungunya, corZika],
            borderColor: "#fff",
            borderWidth: 2
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { position: "bottom" }
        }
    }
});

// ===== GR√ÅFICO 3: TOP 10 BAIRROS =====
new Chart(document.getElementById("graf3Bairros"), {
    type: "bar",
    data: {
        labels: bairros,
        datasets: [{
            label: "Casos por Bairro",
            data: casosBairros,
            backgroundColor: "#10B981",
            borderRadius: 4
        }]
    },
    options: {
        indexAxis: "y",
        responsive: true,
        plugins: {
            legend: { display: true }
        },
        scales: {
            x: { beginAtZero: true }
        }
    }
});

// ===== GR√ÅFICO 4: IMPACTO CHUVAS (SCATTER) =====
if (chuvaVals.length > 0) {
    const scatterData = chuvaVals.map((c, i) => ({ x: c, y: dengueVals[i] }));
    new Chart(document.getElementById("graf4Chuva"), {
        type: "scatter",
        data: {
            datasets: [{
                label: "Chuva (mm) vs Dengue",
                data: scatterData,
                backgroundColor: "rgba(79, 70, 229, 0.6)",
                borderColor: "#4F46E5",
                borderWidth: 1,
                pointRadius: 4
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: true }
            },
            scales: {
                x: { title: { display: true, text: "Chuva (mm)" } },
                y: { title: { display: true, text: "Casos Dengue" } }
            }
        }
    });
}

// ===== GR√ÅFICO 5: INTERNA√á√ïES POR ANO =====
new Chart(document.getElementById("graf5Internacoes"), {
    type: "line",
    data: {
        labels: anos,
        datasets: [{
            label: "Interna√ß√µes",
            data: internacoes,
            borderColor: corInternacoes,
            backgroundColor: "rgba(255, 146, 43, 0.1)",
            tension: 0.4,
            borderWidth: 2,
            fill: true
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// ===== GR√ÅFICO 6: MORTALIDADE POR ANO =====
new Chart(document.getElementById("graf6Mortes"), {
    type: "bar",
    data: {
        labels: anos,
        datasets: [{
            label: "√ìbitos",
            data: mortes,
            backgroundColor: corMortes,
            borderRadius: 6
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// ===== GR√ÅFICO 7: CAPACIDADE VS ATENDIMENTO =====
if (mesesLabels.length > 0) {
    new Chart(document.getElementById("graf7Capacidade"), {
        type: "line",
        data: {
            labels: mesesLabels,
            datasets: [
                {
                    label: "Atendimentos",
                    data: atendimentosMes,
                    borderColor: "#06B6D4",
                    backgroundColor: "rgba(6, 182, 212, 0.1)",
                    tension: 0.4,
                    borderWidth: 2,
                    fill: true
                },
                {
                    label: "Capacidade",
                    data: capacidadeMes,
                    borderColor: corCapacidade,
                    backgroundColor: "rgba(79, 70, 229, 0.1)",
                    tension: 0.4,
                    borderWidth: 2,
                    fill: true
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
}

// ===== GR√ÅFICO 8: TEMPO DE ESPERA POR BAIRRO =====
new Chart(document.getElementById("graf8Tempo"), {
    type: "bar",
    data: {
        labels: bairrosTempo,
        datasets: [{
            label: "Tempo M√©dio de Espera (min)",
            data: temposEspera,
            backgroundColor: "#EC4899",
            borderRadius: 4
        }]
    },
    options: {
        indexAxis: "y",
        responsive: true,
        scales: {
            x: { beginAtZero: true }
        }
    }
});
</script>

{% endblock %}
